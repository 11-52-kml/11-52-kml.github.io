<!doctype html>
<html lang="sr">
<head>
  <meta charset="utf-8" />
  <title>In memoriam — lokacije</title>
  <meta name="viewport" content="width=device-width,initial-scale=1" />
</head>
<body>
  <h1>In memoriam — lokacije</h1>
  <table id="tbl" border="1" cellpadding="6">
    <thead><tr><th>Grad/slot</th><th>Grad</th><th>Kontakt</th><th>Status</th></tr></thead>
    <tbody></tbody>
  </table>

  <script>
  const URL = 'https://script.google.com/macros/u/5/s/AKfycbz9XwR9sw-mpJeIGL7tmUEY_9dtQBAyHaGnBwKsBMtmxE1PyzNGe9EH6K-SCJMGMzY/exec?token=bweobwbnwq13bbwmodfgwfgkermtm&format=json';

  fetch(URL)
    .then(r => {
      if (!r.ok) throw new Error('HTTP ' + r.status);
      return r.json();
    })
    .then(rows => {
      const tbody = document.querySelector('#tbl tbody');
      tbody.innerHTML = '';
      rows.forEach(r => {
        const tr = document.createElement('tr');
        tr.innerHTML = `
          <td>${escapeHtml(r['Public_slot_label'] || '')}</td>
          <td>${escapeHtml(r['Grad'] || '')}</td>
          <td><a href="${escapeAttr(r['Kontakt'] || '')}" target="_blank" rel="noopener">${escapeHtml(r['Kontakt'] || '')}</a></td>
          <td>${escapeHtml(r['Status'] || '')}</td>
        `;
        tbody.appendChild(tr);
      });
    })
    .catch(err => {
      console.error(err);
      document.querySelector('#tbl tbody').innerHTML =
        `<tr><td colspan="4">Greška pri učitavanju podataka.</td></tr>`;
    });

  function escapeHtml(s){ return String(s).replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }
  function escapeAttr(s){ return String(s).replace(/"/g,'&quot;'); }
  </script>
</body>
</html>
